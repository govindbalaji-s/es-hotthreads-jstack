::: {Govind-Balaji-S}{LBUSH3whSeSCfwGFs7DCog}{5ZrSuyZtSkq1VzuLo1VVbw}{127.0.0.1}{127.0.0.1:9300}{cdhilmrstw}{ml.machine_memory=17179869184, xpack.installed=true, transform.node=true, ml.max_open_jobs=20, ml.max_jvm_size=8589934592}
   Hot threads at 2021-07-08T11:22:22.070Z, interval=2s, busiestThreads=3, ignoreIdleThreads=true:

   70.7% (1.4s out of 2s) cpu usage by thread 'elasticsearch[Govind-Balaji-S][search][T#7][[kibana_sample_data_ecommerce][0]][taskId=LBUSH3whSeSCfwGFs7DCog:2146]'
     2/10 snapshots sharing following 29 elements
       example.MemorySpamAgg$MapScriptFactory$1.execute(MemorySpamAgg.java:78)
       app//org.elasticsearch.search.aggregations.metrics.ScriptedMetricAggregator$1.collect(ScriptedMetricAggregator.java:124)
       app//org.elasticsearch.search.aggregations.LeafBucketCollector.collect(LeafBucketCollector.java:96)
       app//org.apache.lucene.search.MultiCollector$MultiLeafCollector.collect(MultiCollector.java:192)
       app//org.apache.lucene.search.MatchAllDocsQuery$1$1.score(MatchAllDocsQuery.java:64)
       app//org.elasticsearch.search.internal.CancellableBulkScorer.score(CancellableBulkScorer.java:45)
       app//org.apache.lucene.search.BulkScorer.score(BulkScorer.java:39)
       app//org.elasticsearch.search.internal.ContextIndexSearcher.searchLeaf(ContextIndexSearcher.java:215)
       app//org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:188)
       app//org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:445)
       app//org.elasticsearch.search.query.QueryPhase.searchWithCollector(QueryPhase.java:331)
       app//org.elasticsearch.search.query.QueryPhase.executeInternal(QueryPhase.java:286)
       app//org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:138)
       app//org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:371)
       app//org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:434)
       app//org.elasticsearch.search.SearchService.access$500(SearchService.java:136)
       app//org.elasticsearch.search.SearchService$2.lambda$onResponse$0(SearchService.java:402)
       app//org.elasticsearch.search.SearchService$2$$Lambda$5978/0x0000000801931e08.get(Unknown Source)
       app//org.elasticsearch.search.SearchService$$Lambda$5979/0x0000000801932030.get(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable.lambda$supply$0(ActionRunnable.java:47)
       app//org.elasticsearch.action.ActionRunnable$$Lambda$5278/0x0000000801795878.accept(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable$2.doRun(ActionRunnable.java:62)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       app//org.elasticsearch.common.util.concurrent.TimedRunnable.doRun(TimedRunnable.java:33)
       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:732)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
       java.base@15.0.1/java.lang.Thread.run(Thread.java:832)
     2/10 snapshots sharing following 30 elements
       java.base@15.0.1/java.util.AbstractList$Itr.hasNext(AbstractList.java:364)
       example.MemorySpamAgg$MapScriptFactory$1.execute(MemorySpamAgg.java:91)
       app//org.elasticsearch.search.aggregations.metrics.ScriptedMetricAggregator$1.collect(ScriptedMetricAggregator.java:124)
       app//org.elasticsearch.search.aggregations.LeafBucketCollector.collect(LeafBucketCollector.java:96)
       app//org.apache.lucene.search.MultiCollector$MultiLeafCollector.collect(MultiCollector.java:192)
       app//org.apache.lucene.search.MatchAllDocsQuery$1$1.score(MatchAllDocsQuery.java:64)
       app//org.elasticsearch.search.internal.CancellableBulkScorer.score(CancellableBulkScorer.java:45)
       app//org.apache.lucene.search.BulkScorer.score(BulkScorer.java:39)
       app//org.elasticsearch.search.internal.ContextIndexSearcher.searchLeaf(ContextIndexSearcher.java:215)
       app//org.elasticsearch.search.internal.ContextIndexSearcher.search(ContextIndexSearcher.java:188)
       app//org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:445)
       app//org.elasticsearch.search.query.QueryPhase.searchWithCollector(QueryPhase.java:331)
       app//org.elasticsearch.search.query.QueryPhase.executeInternal(QueryPhase.java:286)
       app//org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:138)
       app//org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:371)
       app//org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:434)
       app//org.elasticsearch.search.SearchService.access$500(SearchService.java:136)
       app//org.elasticsearch.search.SearchService$2.lambda$onResponse$0(SearchService.java:402)
       app//org.elasticsearch.search.SearchService$2$$Lambda$5978/0x0000000801931e08.get(Unknown Source)
       app//org.elasticsearch.search.SearchService$$Lambda$5979/0x0000000801932030.get(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable.lambda$supply$0(ActionRunnable.java:47)
       app//org.elasticsearch.action.ActionRunnable$$Lambda$5278/0x0000000801795878.accept(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable$2.doRun(ActionRunnable.java:62)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       app//org.elasticsearch.common.util.concurrent.TimedRunnable.doRun(TimedRunnable.java:33)
       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:732)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
       java.base@15.0.1/java.lang.Thread.run(Thread.java:832)
     2/10 snapshots sharing following 27 elements
       java.base@15.0.1/java.util.HashMap$HashIterator.nextNode(HashMap.java:1588)
       java.base@15.0.1/java.util.HashMap$KeyIterator.next(HashMap.java:1607)
       app//org.elasticsearch.common.util.CollectionUtils.ensureNoSelfReferences(CollectionUtils.java:167)
       app//org.elasticsearch.common.util.CollectionUtils.ensureNoSelfReferences(CollectionUtils.java:168)
       app//org.elasticsearch.common.util.CollectionUtils.ensureNoSelfReferences(CollectionUtils.java:140)
       app//org.elasticsearch.search.aggregations.metrics.ScriptedMetricAggregator.aggStateForResult(ScriptedMetricAggregator.java:145)
       app//org.elasticsearch.search.aggregations.metrics.ScriptedMetricAggregator.buildAggregation(ScriptedMetricAggregator.java:131)
       app//org.elasticsearch.search.aggregations.metrics.MetricsAggregator.buildAggregations(MetricsAggregator.java:48)
       app//org.elasticsearch.search.aggregations.Aggregator.buildTopLevel(Aggregator.java:143)
       app//org.elasticsearch.search.aggregations.AggregationPhase.execute(AggregationPhase.java:113)
       app//org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:144)
       app//org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:371)
       app//org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:434)
       app//org.elasticsearch.search.SearchService.access$500(SearchService.java:136)
       app//org.elasticsearch.search.SearchService$2.lambda$onResponse$0(SearchService.java:402)
       app//org.elasticsearch.search.SearchService$2$$Lambda$5978/0x0000000801931e08.get(Unknown Source)
       app//org.elasticsearch.search.SearchService$$Lambda$5979/0x0000000801932030.get(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable.lambda$supply$0(ActionRunnable.java:47)
       app//org.elasticsearch.action.ActionRunnable$$Lambda$5278/0x0000000801795878.accept(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable$2.doRun(ActionRunnable.java:62)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       app//org.elasticsearch.common.util.concurrent.TimedRunnable.doRun(TimedRunnable.java:33)
       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:732)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
       java.base@15.0.1/java.lang.Thread.run(Thread.java:832)
     3/10 snapshots sharing following 25 elements
       app//org.elasticsearch.common.util.CollectionUtils.ensureNoSelfReferences(CollectionUtils.java:168)
       app//org.elasticsearch.common.util.CollectionUtils.ensureNoSelfReferences(CollectionUtils.java:168)
       app//org.elasticsearch.common.util.CollectionUtils.ensureNoSelfReferences(CollectionUtils.java:140)
       app//org.elasticsearch.search.aggregations.metrics.ScriptedMetricAggregator.aggStateForResult(ScriptedMetricAggregator.java:145)
       app//org.elasticsearch.search.aggregations.metrics.ScriptedMetricAggregator.buildAggregation(ScriptedMetricAggregator.java:131)
       app//org.elasticsearch.search.aggregations.metrics.MetricsAggregator.buildAggregations(MetricsAggregator.java:48)
       app//org.elasticsearch.search.aggregations.Aggregator.buildTopLevel(Aggregator.java:143)
       app//org.elasticsearch.search.aggregations.AggregationPhase.execute(AggregationPhase.java:113)
       app//org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:144)
       app//org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:371)
       app//org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:434)
       app//org.elasticsearch.search.SearchService.access$500(SearchService.java:136)
       app//org.elasticsearch.search.SearchService$2.lambda$onResponse$0(SearchService.java:402)
       app//org.elasticsearch.search.SearchService$2$$Lambda$5978/0x0000000801931e08.get(Unknown Source)
       app//org.elasticsearch.search.SearchService$$Lambda$5979/0x0000000801932030.get(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable.lambda$supply$0(ActionRunnable.java:47)
       app//org.elasticsearch.action.ActionRunnable$$Lambda$5278/0x0000000801795878.accept(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable$2.doRun(ActionRunnable.java:62)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       app//org.elasticsearch.common.util.concurrent.TimedRunnable.doRun(TimedRunnable.java:33)
       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:732)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
       java.base@15.0.1/java.lang.Thread.run(Thread.java:832)
     unique snapshot
       app//org.elasticsearch.common.util.CollectionUtils.ensureNoSelfReferences(CollectionUtils.java:167)
       app//org.elasticsearch.common.util.CollectionUtils.ensureNoSelfReferences(CollectionUtils.java:168)
       app//org.elasticsearch.common.util.CollectionUtils.ensureNoSelfReferences(CollectionUtils.java:140)
       app//org.elasticsearch.search.aggregations.metrics.ScriptedMetricAggregator.aggStateForResult(ScriptedMetricAggregator.java:145)
       app//org.elasticsearch.search.aggregations.metrics.ScriptedMetricAggregator.buildAggregation(ScriptedMetricAggregator.java:131)
       app//org.elasticsearch.search.aggregations.metrics.MetricsAggregator.buildAggregations(MetricsAggregator.java:48)
       app//org.elasticsearch.search.aggregations.Aggregator.buildTopLevel(Aggregator.java:143)
       app//org.elasticsearch.search.aggregations.AggregationPhase.execute(AggregationPhase.java:113)
       app//org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:144)
       app//org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:371)
       app//org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:434)
       app//org.elasticsearch.search.SearchService.access$500(SearchService.java:136)
       app//org.elasticsearch.search.SearchService$2.lambda$onResponse$0(SearchService.java:402)
       app//org.elasticsearch.search.SearchService$2$$Lambda$5978/0x0000000801931e08.get(Unknown Source)
       app//org.elasticsearch.search.SearchService$$Lambda$5979/0x0000000801932030.get(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable.lambda$supply$0(ActionRunnable.java:47)
       app//org.elasticsearch.action.ActionRunnable$$Lambda$5278/0x0000000801795878.accept(Unknown Source)
       app//org.elasticsearch.action.ActionRunnable$2.doRun(ActionRunnable.java:62)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       app//org.elasticsearch.common.util.concurrent.TimedRunnable.doRun(TimedRunnable.java:33)
       app//org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:732)
       app//org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:26)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)
       java.base@15.0.1/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)
       java.base@15.0.1/java.lang.Thread.run(Thread.java:832)

